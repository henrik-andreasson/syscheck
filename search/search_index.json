{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Syscheck - OVerview","text":""},{"location":"#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"ansible/","title":"Syscheck config management via ansible","text":""},{"location":"ansible/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2020-11-01 Initial version"},{"location":"ansible/#configuration-management-ansible","title":"Configuration Management - ansible","text":"<p>syscheck is configurable with ansible.</p>"},{"location":"ansible/#configure","title":"configure","text":"<p>Look at misc/ansible/roles/defaults/main.yml for variables you\u2019d like to customize</p> <p>Then enter them into host_vars or group_vars</p>"},{"location":"ansible/#running","title":"running","text":"<p>put every ting in /misc/ansible or another directory of your choosing</p> <pre><code>ansible-playbook -i /misc/ansible/hosts --limit=host.srv.domain.com -vv /misc/ansible/playbook-syscheck --user username --ask-become --become --become-method=su   --private-key\n</code></pre> <p>=/home/user/.ssh/id_rsa  \u2013connection=ssh</p>"},{"location":"backup-management/","title":"\ufeffSyscheck backup management","text":""},{"location":"backup-management/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2010-10-12 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"backup-management/#introduction","title":"Introduction","text":"<p>Syscheck has the possibility to backup the database to a file in several different locations, these can be used to save hourly, daily, monthly and yearly backups in different locations and save those in different amount of times. Default values of saving the different backups can be adjusted in the config file for \u201cclean old backups script\u201d (/config/908.config)"},{"location":"backup-management/#syscheck-backup-management_1","title":"Syscheck backup management","text":"<p>Syscheck has the possibility to backup the database to a file in several different locations, these can be used to save hourly, daily, monthly and yearly backups in different locations and save those in different amount of times. Default values of saving the different backups can be adjusted in the config file for \u201cclean old backups script\u201d (/config/908.config)"},{"location":"backup-management/#add-the-different-backups-to-crontab","title":"Add the different backups to crontab","text":"<pre><code>$ sudo crontab -e\n# hourly backups at 10 mins past every hour\n10 * * * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh\n\n# daily backups 03:10\n10 3 * * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --daily\n\n# weekly backups on sundays 03:20\n20 3 * * 7 /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --weekly\n\n# monthly backups on first day of month 3:30\n30 3 1 * * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --monthly\n\n# yearly backup on first of januari 3:40\n40 3 1 1 * /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh --yearly\n</code></pre>"},{"location":"backup-management/#make-new-backup-dirs","title":"Make new backup dirs","text":"<pre><code># mkdir -p /backup/mysql/default\n# mkdir -p /backup/mysql/daily\n# mkdir -p /backup/mysql/weekly\n# mkdir -p /backup/mysql/monthly\n# mkdir -p /backup/mysql/yearly\n</code></pre>"},{"location":"backup-management/#run-backup","title":"run backup","text":"<pre><code>[root@ca1 related-enabled]# /opt/syscheck/related-enabled/904_make_mysql_db_backup.sh -s\nI-90401-LAB 20200519 15:11:35 ca1.lab.certificateservices.se: INFO - mysqlbackup Backed up db ok file: /backup/mysql//default/mysql-2020-05-19_15.11.33.gz time to complete(sec): 2 filesize(b\nI-90401-LAB 20200519 15:11:36 ca1.lab.certificateservices.se: INFO - mysqlbackup Backed up db ok file: /backup/mysql//default/ejbca-2020-05-19_15.11.35.gz time to complete(sec): 1 filesize(b\n</code></pre>"},{"location":"backup-management/#enable-the-clean-old-backups-script","title":"Enable the clean old backups script","text":"<pre><code>    cd /opt/syscheck/related-enabled/\n    syscheck/related-enabled#  ln -s ../related-available/908_clean_old_backups.sh .\n</code></pre>"},{"location":"backup-management/#verify-the-config-file","title":"Verify the config file","text":"<pre><code>    $ sudo vi /opt/syscheck/config/908.config\n</code></pre> <pre><code>### config for 908_clean_old_backups.sh\n\nKEEPDAYS[0]=10;\nBACKUPDIR[0]=\"/backup/mysql/default/\";\nDATESTR[0]=`${SYSCHECK_HOME}/lib/x-days-ago-datestring.pl ${KEEPDAYS[0]}  2&gt;/dev/null`;\nFILENAME[0]=\"${BACKUPDIR[0]}/ejbcabackup-${DATESTR[0]}*\"\n\nKEEPDAYS[1]=30;\nBACKUPDIR[1]=\"/backup/mysql/daily\";\nDATESTR[1]=`${SYSCHECK_HOME}/lib/x-days-ago-datestring.pl ${KEEPDAYS[0]}  2&gt;/dev/null`;\nFILENAME[1]=\"${BACKUPDIR[0]}/ejbcabackup-${DATESTR[0]}*\"\n\n\nKEEPDAYS[2]=90;\nBACKUPDIR[2]=\"/backup/mysql/weekly/\";\nDATESTR[2]=`${SYSCHECK_HOME}/lib/x-days-ago-datestring.pl ${KEEPDAYS[1]}  2&gt;/dev/null`;\nFILENAME[2]=\"${BACKUPDIR[1]}/ejbcabackup-${DATESTR[1]}*\"\n\nKEEPDAYS[3]=370;\nBACKUPDIR[3]=\"/backup/mysql/monthly/\";\nDATESTR[3]=`${SYSCHECK_HOME}/lib/x-days-ago-datestring.pl ${KEEPDAYS[1]}  2&gt;/dev/null`;\nFILENAME[3]=\"${BACKUPDIR[1]}/ejbcabackup-${DATESTR[1]}*\"\n</code></pre>"},{"location":"backup-management/#add-clean-old-backups-to-crontab","title":"Add clean old backups to crontab","text":"<p>$ sudo crontab -e</p> <pre><code># at 4:10 am each day clean old backups\n10 4 * * * /opt/syscheck/related-enabled/908_clean_old_backups.sh\n</code></pre>"},{"location":"certificate_and_revovation_archival/","title":"Certificate and revocation Archival","text":""},{"location":"certificate_and_revovation_archival/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"certificate_and_revovation_archival/#intro","title":"Intro","text":"<p>From syscheck 1.2 and on there is a script-based archival solution. New and revoked certificates are stored on local disk in a file-tree and optional remote SSH server.</p>"},{"location":"certificate_and_revovation_archival/#setup-of-syscheck","title":"Setup of syscheck","text":"<p>First we need to configure 917_archive_file.sh that is a general archiving script. Do that by edit /conf/917.conf, make the directories \u201cInTransitDir\u201d and \u201cArchiveDir\u201d. Also make sure that users of  917_archive_file.sh can write to those directories. InTransitDir will be used as a temporary location when transferring files to remote hosts. ArchiveDir is the final destination on localhost. <pre><code># config for 917_archive_file.sh\nInTransitDir=/misc/cert-archive/intransit\nArchiveDir=/misc/cert-archive/archive\n\n#OUTFILE=\"${OUTPATH2}/archived-crl-${DATE}-${CRLLASTUPDATE2}-${CRLISSUER2}\"\nOUTFILE=\"${OUTPATH2}/${CRLISSUER2}\"\n</code></pre> <p>Now we\u2019ll configure the destinations for cert-, crl- and revocationarchiving. Edit /config/900.conf with your destinations. <pre><code># config for related-available/900_export_cert.sh\n\n### config ###\nOUTPATH=/misc/cert-archive/local\nCERTLOG=${OUTPATH}/exportcert.log\nDATE=`date +'%Y-%m-%d_%H.%m.%S'`\nDATE2=`date +'%Y/%m/%d'`\n\nOUTPATH2=\"${OUTPATH}/${DATE2}\"\n\n# If you configure one or more REMOTE_HOST:s the archived certificate will also be stored on that host\nREMOTE_HOST[0]=\"192.168.158.131\"\nREMOTE_USER[0]='htmf'\nREMOTE_DIR[0]='/misc/cert-archive/'\nSSHKEY[0]='/home/han/.ssh/id_rsa'\n\nREMOTE_HOST[1]=\"127.0.0.1\"\nREMOTE_USER[1]='han'\nREMOTE_DIR[1]='/misc/cert-archive/'\nSSHKEY[1]='/home/han/.ssh/id_rsa'\n\n### end config ###\n</code></pre> <p>You can add more destinations just copy the config block and add \u201c1\u201d to the config index. Like this:</p> <pre><code>REMOTE_HOST[2]=\"127.0.0.1\"\nREMOTE_USER[2]='han'\nREMOTE_DIR[2]='/misc/cert-archive/'\nSSHKEY[2]='/home/han/.ssh/id_rsa'\n</code></pre> <p>Do the same with  </p> <pre><code>    &lt;syscheck&gt;/config/901.conf ( config for 901_export_revocation.sh)\n</code></pre> <p>and</p> <pre><code>    &lt;syscheck&gt;/config/902.conf ( config for 902_export_crl.sh)\n</code></pre>"},{"location":"certificate_and_revovation_archival/#setup-of-publisher","title":"Setup of publisher","text":"<p>Go to: EJBCA Adminweb \u2192 \u201dEdit Publishers\u201d \u2192 Add new name: \u201dArchival publisher\u201d</p> <p>Select/ enter the following: Publisher Type: \u201dCustom Publisher\u201d Class Path: \u201dorg.ejbca.core.model.ca.publisher.GeneralPurposeCustomPublisher\u201d</p> <p>Properties of Custom Publisher:</p> <pre><code>crl.application /path/to/syscheck/related-enabled/902_export_crl.sh\ncrl.failOnStandardError true\ncrl.failOnErrorCode true\ncert.application /path/to/syscheck/related-enabled/900_export_cert.sh\ncert.failOnStandardError true\ncert.failOnErrorCode true\nrevoke.application /path/to/syscheck/related-enabled/901_export_revocation.sh\nrevoke.failOnStandardError true\nrevoke.failOnErrorCode true\n</code></pre> <p>Use the publisher on CA:s</p> <p>Go to: EJBCA Adminweb \u2192 \u201dEdit Certificate Authorites\u201d</p> <p>Select the CA you want CRL archival on, then click on edit CA</p> <p>At \u201dCRL Publishers\u201d:</p> <p>Select \u201dArchival publisher\u201d</p> <p>Do this for all CA:s you want CRL Archival for.</p> <p>Use the publisher on Certificate profile:s</p> <p>Go to: EJBCA Adminweb \u2192 \u201dEdit Certifcate Profiles\u201d</p> <p>At: \u201dPublishers\u201d</p> <p>Select \u201dArchival publisher\u201d</p> <p>Do this for all Certificate profiles:s you want Certifcate Archival for.</p>"},{"location":"cmp_dates/","title":"Syscheck - Syscheck component cmp_dates.py","text":""},{"location":"cmp_dates/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 translate tool to pyton + mkdocs updates"},{"location":"cmp_dates/#intro","title":"Intro","text":"<pre><code>usage: Util to check validity, compares two date strings and calculate the time left. Calculates also two limits WARN (1/2 of the CRL lifetime), ERROR( 1/4 left of the lifetime). The process returns with these values  0 -&gt; ok,  1 -&gt; warn ,  2 -&gt; error,  3 -&gt; expired.\n       [-h] [--warnminutes WARNMINUTES] [--errorminutes ERRORMINUTES]\n       [--minutes] [--diff] [--noyearnotz] [--verbose]\n       date1 date2\n\npositional arguments:\n  date1                 date1 ex: \"Mar 18 11:30:38 2017 GMT\"\n  date2                 date2 ex: \"Mar 18 19:30:38 2017 GMT\"\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --warnminutes WARNMINUTES\n                        set custom level for warning in minutes\n  --errorminutes ERRORMINUTES\n                        set custom level for error in minutes\n  --minutes             just return minutes to warn\n  --diff                just return minutes between the dates\n  --noyearnotz          datetime without year and tz (aka syslog format) ex:\n                        Jul 27 11:36:54\n  --verbose\n</code></pre>"},{"location":"config-management/","title":"Syscheck config management","text":""},{"location":"config-management/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"config-management/#configuration-management","title":"Configuration Management","text":""},{"location":"config-management/#ansible","title":"ansible","text":"<p>syscheck is configurable with ansible. for more info see the misc/ansible directory.</p>"},{"location":"config-management/#manually","title":"manually","text":"<p>Each script has a config under config/</p>"},{"location":"config-management/#syscheck-scripts","title":"syscheck-scripts","text":"<p>Enable scripts by making a soft link (ln -s) in \u201cscripts-enabled\u201d to \u201cscripts-available\u201d where all scripts reside.</p> <p>enable one script:</p> <pre><code>    # cd scripts-enabled\n    # ln -s ../scripts-available/sc_01_disk_usage.sh .\n</code></pre> <p>enable all script:</p> <pre><code>    # cd scripts-enabled\n    # ln -s ../scripts-available/* .\n</code></pre> <p>make a test-run by doing:</p> <pre><code>    ./syscheck.sh -s\n</code></pre> <p>if it works out good (All is OK), then go ahead and try</p> <pre><code>    ./sysheck.sh\n</code></pre> <p>then check your syslog-logs</p>"},{"location":"config-management/#related-scripts","title":"Related scripts","text":"<p>Related scripts are other scripts not intended to be run every x min like the core syscheck script but maybe by cron every now and then, maybe by a admin manually to perform a maintenance task.</p> <p>To list the available scripts look in related-available</p> <pre><code>    ls  related-available\n</code></pre> <p>To find out more about a certain script run with \u201c-h\u201d as argument:</p> <pre><code>    related-available/900_export_cert.sh -h\n</code></pre> <p>To enable a script:</p> <pre><code>    cd related-enabled\n    ln -s ../related-available/900_export_cert.sh .\n</code></pre> <p>Why should you only use related scripts from \u201crelated-enabled\u201d?  - Those are configured and tested on this particular installation, so do make it a habit to run stuff only from \u201crelated-enabled\u201d</p>"},{"location":"getroot/","title":"Syscheck - GetRoot Tool","text":""},{"location":"getroot/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"getroot/#intro","title":"Intro","text":"<p>Small tool to log why you need root before getting access. This is of course in no way enforceable but still easy to follow up if operators do not log their reason. As an incentive getroot manages putting syscheck on hold for the operator.</p>"},{"location":"getroot/#becoming-root","title":"Becoming root","text":"<pre><code>$ ./getroot.sh\n./getroot.sh: Tool to log changes and to pause syscheck\n\nPlease state a short but clear reason why you need root\n&gt; Change CHG123456 - update the version of syscheck\nstop any new syscheck scripts Y/n?y\n[sudo] password for han:\n# #do upgrade\n# # now all syscheck batch jobs will not run\n# # exit when ready\n# exit\nlogout\nSyscheck is on hold, are you done Y/n?y\n</code></pre>"},{"location":"getroot/#becoming-root-keeping-syscheck-on-hold","title":"Becoming root, keeping syscheck on-hold.","text":"<pre><code>$ ./getroot.sh\n./getroot.sh: Tool to log changes and to pause syscheck\n\nPlease state a short but clear reason why you need root\n&gt; Change CHG123456 - update the version of syscheck\nstop any new syscheck scripts Y/n?y\nroot@vroom:~# exit\nlogout\nSyscheck is on hold, are you done Y/n?n\n</code></pre>"},{"location":"getroot/#next-time-getroot-is-started-is-asks-if-your-done","title":"Next time getroot is started, is asks if your done","text":"<pre><code>$ ./getroot.sh\nSyscheck is on hold, are you done Y/n?y\n700 00 I 7004 han (1000) User:  is done with root reason:  Sun Nov 19 12:32:52 CET 2017:upgrade syscheck:han\n</code></pre>"},{"location":"getting-started/","title":"Syscheck getting started","text":""},{"location":"getting-started/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"getting-started/#activate-selected-related-scripts","title":"Activate selected related scripts","text":"<p>Make the soft links in the related-enabled directory.</p> <pre><code>    han@ca-nod1:/opt/syscheck/related-enabled&gt; ln -s ../related-available/904_make_mysql_db_backup.sh .\n</code></pre> <p>Verify there is soft links and no copied files in enabled!</p> <pre><code>    username@smartcard20-node1:/opt/syscheck/syscheck/related-enabled&gt; ls -al\n    lrwxrwxrwx  1 root root   48 2010-06-04 14:25 904_make_mysql_db_backup.sh -&gt; ../related-available/904_make_mysql_db_backup.sh\n</code></pre> <p>Also check the config for each script you activate, there may or may not be anything to config, but let\u2019s check.</p> <pre><code>    username@smartcard20-node1:/opt/syscheck/&gt; sudo vi config/900.conf\n    username@smartcard20-node1:/opt/syscheck/&gt; sudo vi config/904.conf\n    [...]\n</code></pre>"},{"location":"getting-started/#mysql-database-configuration","title":"Mysql database configuration","text":"<p>Config database parameters</p> <p>Make sure settings are correct in the syscheck config/common.conf</p> <pre><code>    DB_NAME=ejbca\n    DB_USER=ejbca\n    DB_PASSWORD=\"sdfiuh3wrnj\"\n    MYSQLROOT_PASSWORD=\"UiywfeW23\"\n</code></pre>"},{"location":"help-getroot/","title":"getroot help","text":"<p>./getroot.sh: Tool become root and to log changes and to pause syscheck</p> <p>Please state a short but clear reason why you need root</p> <p>Scriptid: 700 - get root</p> <p>This is syscheck, getroot.sh it ask for a reason to get root, logs it then asks if syscheck scripts should be put on hold.</p> <p>Syntax: ./getroot.sh (run interactive) -p|\u2013pause to automatically set/unset syscheck on/off pause -r|\u2013reason  set reason from arg <p>Error code / description - What to do</p> <p>7001 / User: %s is getting root reason: %s -  7002 / User: %s is getting root reason: %s -  7003 / User: %s is getting root, with syscheck on hold reason: %s -  7004 / User: %s is done with root reason: %s - </p> <p>to run with output directed to screen: add a \u2018-s\u2019 or \u2018\u2013screen\u2019</p>"},{"location":"help-logbook/","title":"Logbook Help","text":"<p>./logbook.sh: </p> <p>Scriptid: 701 - Log book</p> <p>This is syscheck, loogbook.sh it ask for a entry then logs it.</p> <p>-p|\u2013post - to post a new message -r|\u2013read - to read already posted</p> <p>Error code / description - What to do</p> <p>7011 / User: %s ; Logentry: %s - Logmessage</p> <p>to run with output directed to screen: add a \u2018-s\u2019 or \u2018\u2013screen\u2019</p>"},{"location":"install/","title":"Syscheck - Install","text":""},{"location":"install/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"install/#manually","title":"manually","text":"<p>untar the distribution in a suitable directory (default /usr/local/syscheck). Then edit config/common.conf config/xxx.conf (where xxx is ther scriptid) to fit your needs.</p>"},{"location":"install/#packaged-rpm-and-deb","title":"packaged (rpm and deb)","text":"<p>Download the rpm/deb from github</p> <p>rpm -Uvh syscheck-.rpm <p>dpkg -i syscheck-.deb"},{"location":"integration-with-op5/","title":"Syscheck integration with op5 and icinga","text":""},{"location":"integration-with-op5/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"integration-with-op5/#introduction","title":"Introduction","text":"<p>OP5 is an enterprise monitoring solution initally based on nagios.</p> <p>Icinga is a comunity driven fork of nagios.</p> <p>Purpose of the integration is to send infomration from servers that is out of reach for the regular agent.</p>"},{"location":"integration-with-op5/#config","title":"config","text":"<p>OP5 and Icinga is turned on/off in config/common.conf</p> <pre><code># send log messages to icinga http api\n# values: 0 - disabled or 1 - enabled\nSENDTO_ICINGA=0\n\n# send log messages to OP5 http api\n# values: 0 - disabled or 1 - enabled\nSENDTO_OP5=1\n</code></pre> <p>Then API username and password is set in config/monitoring.conf</p> <pre><code># monitoring\n\nICINGA_USER=\"root\"\nICINGA_PASS=\"foo123\"\nICINGA_API_URL=\"https://icingaservername:5665/v1/actions/\"\n\n\nOP5_USER=\"root\"\nOP5_PASS=\"foo123x\"\nOP5_API_URL=\"https://op5servername/api/command/PROCESS_SERVICE_CHECK_RESULT\"\n</code></pre>"},{"location":"integration-with-op5/#example-work-flow","title":"Example Work flow","text":"<ul> <li>Syscheck run every 10 min</li> <li>As a part of the run syscheck sends information to OP5</li> <li>sample request:<pre><code>curl -u 'status_update:mysecret' -H 'content-type: application/json' -d '{\"host_name\":\"example_host_1\",\"service_description\":\"Example service\", \"status_code\":\"2\",\"plugin_output\":\"Example issue has occurred\"}' 'https://monitorserver/api/command/PROCESS_SERVICE_CHECK_RESULT'\n</code></pre> </li> </ul>"},{"location":"integration-with-op5/#references","title":"References","text":"<p>OP5 API</p> <p>Icinga API</p>"},{"location":"logbook/","title":"Syscheck - LOGBOOK Tool","text":""},{"location":"logbook/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates <p>Log book is a tool to log activities by the operators, it may be trouble shooting, handover of problems/incidents to next operator or any important info.</p>"},{"location":"logbook/#to-enable-sudo-run","title":"to enable sudo run:","text":"<pre><code>usermod -D wheel -a username\n</code></pre>"},{"location":"logbook/#logbook-samples","title":"logbook samples","text":"<p>Help:</p> <pre><code>$ ./logbook.sh -h\n./logbook.sh: Tool to log messages to syscheck\n\nThis is syscheck, loogbook.sh it ask for a entry then logs it.\n./logbook.sh [ -r &lt;days&gt; |  -p ] (read is default)\n</code></pre> <p>to post an entry, it is a single line, need more lines, just run again.</p> <pre><code>$ ./logbook.sh -p\n./logbook.sh: Tool to log messages to syscheck\n\nEnter any type of info that needs to be logged into the logbook (max 160 chars)\n&gt; Fault tracing the server is slow\n</code></pre> <p>read the log, press enter to see next day, ctrl-c to exit</p> <pre><code>$ ./logbook.sh -r\n./logbook.sh: Tool to log messages to syscheck\n\nLogentries for: 20171119\n701-00-I-7011-PKI 20171119 11:54:28 vroom: INFO - User: han ; Logentry: Fault tracing the server is slow\nend-of-entries, press enter to see next day\nLogentries for: 20171118\nend-of-entries, press enter to see next day\nLogentries for: 20171117\nend-of-entries, press enter to see next day\nLogentries for: 20171116\n700-00-I-7003-PKI 20171116 15:48:23 vroom: INFO - User: han is getting root, with syscheck on hold reason: Change #363636 - update keystore 47\n700-00-I-7004-PKI 20171116 15:48:31 vroom: INFO - User: han is done with root reason: Change #363636 - update keystore 47\nend-of-entries, press enter to see next day\nLogentries for: 20171115\nend-of-entries, press enter to see next day^C\n</code></pre> <p>read the log x days and exit (put it in your .bashrc maybe)</p> <pre><code>$ ./logbook.sh -r 7\n./logbook.sh: Tool to log messages to syscheck\n\nLogentries for: 20171119\n701-00-I-7011-PKI 20171119 11:54:28 vroom: INFO - User: han ; Logentry: Fault tracing the server is slow\nLogentries for: 20171118\nLogentries for: 20171117\nLogentries for: 20171116\n700-00-I-7003-PKI 20171116 15:48:23 vroom: INFO - User: han is getting root, with syscheck on hold reason: Change #363636 - update keystore 47\n700-00-I-7004-PKI 20171116 15:48:31 vroom: INFO - User: han is done with root reason: Change #363636 - update keystore 47\n701-00-I-7011-PKI 20171116 15:49:21 vroom: INFO - User: han ; Logentry: ny var det konstigt\nLogentries for: 20171115\nLogentries for: 20171114\nLogentries for: 20171113\n</code></pre>"},{"location":"output-destinations/","title":"Syscheck - LOGBOOK Tool","text":""},{"location":"output-destinations/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"output-destinations/#output-to-file","title":"Output to File","text":"<p>syscheck can write to a local file, this can be collected by filebeat to be managed in ELK.</p>"},{"location":"output-destinations/#output-to-syslog","title":"Output to  Syslog","text":"<p>Sycheck will send messages to a local syslog server, that server can of course route the messages to a central syslog.</p> <p>Rsyslog has native support for SSL, use this to make sure the messages are kept confidential during transport.</p> <p>You still can use any syslog implementation.</p>"},{"location":"output-destinations/#output-to-icinga","title":"Output to  Icinga","text":"<p>syscheck can send check result directly to icinga  http api</p> <p>Icinga API https://icinga.com/docs/icinga2/latest/doc/12-icinga2-api/</p>"},{"location":"output-destinations/#output-to-op5","title":"Output to  OP5","text":"<p>OP5 is an enterprise monitoring solution initally based on nagios. Purpose of the integration is to send infomration from servers that is out of reach for the regular agent.</p> <p>Example Work flow</p> <ul> <li>Syscheck run every 10 min</li> <li>As a part of the run syscheck sends information to OP5</li> <li>sample request:<pre><code>curl -u 'status_update:mysecret' -H 'content-type: application/json' -d '{\"host_name\":\"example_host_1\",\"service_description\":\"Example service\", \"status_code\":\"2\",\"plugin_output\":\"Example issue has occurred\"}' 'https://monitorserver/api/command/PROCESS_SERVICE_CHECK_RESULT'\n</code></pre> </li> </ul> <p>References</p> <p>Nagios API https://kb.op5.com/display/HOWTOs/Submitting+status+updates+through+the+HTTP+API</p>"},{"location":"output-destinations/#output-to-elastic-stack","title":"Output to  Elastic Stack","text":"<p>The JSON output was added for easy integration with elastic.</p> <p>Sample setup:</p> <pre><code>[syscheck installed ] -&gt; [ file output            ] -&gt; [ filebeat reads ] -&gt; [ logstash     ] -&gt; [ icinga   ]\n[on a server]            [ \"/var/log/syscheck.log\"]    [ sends logrows  ]    [ icinga ouput ]    [ alerting ]\n</code></pre> <p>Read more: * https://www.elastic.co/beats/filebeat * https://www.elastic.co</p>"},{"location":"output-format/","title":"Syscheck output formats","text":""},{"location":"output-format/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"output-format/#introduction","title":"Introduction","text":"<p>in version 1.7 JSON output format was added.</p> <p>in version 1.6 the output format has changes to support pushing messages to icinga/nagios (and mayby other monitoring solutions also).</p>"},{"location":"output-format/#info-json-syscheck-sample-output","title":"Info - JSON Syscheck Sample output","text":"<pre><code>{ \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"01\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"E\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.388541169\", \"LONGLEVEL\":  \"ERROR\", \"DESCRIPTION\": \"Diskusage exceeded ( is  percent used: Limit is  percent)\", \"EXTRAARG1\":   \"/\", \"EXTRAARG2\":   \"99\", \"EXTRAARG3\":   \"75\", \"EXTRAARG4\":   \"\", \"EXTRAARG5\":   \"\", \"EXTRAARG6\":   \"\", \"EXTRAARG7\":   \"\", \"EXTRAARG8\":   \"\", \"EXTRAARG9\":   \"\", \"LEGACYFMT\":   \"01-01-E-02-PKI 20150426 20:59:32 bang: ERROR - Diskusage exceeded (/ is 99 percent used: Limit is 75 percent)\" }\n{ \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"01\", \"SCRIPTINDEX\": \"02\", \"LEVEL\": \"E\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.416035932\", \"LONGLEVEL\":  \"ERROR\", \"DESCRIPTION\": \"Diskusage exceeded ( is  percent used: Limit is  percent)\", \"EXTRAARG1\":   \"/backup\", \"EXTRAARG2\":   \"99\", \"EXTRAARG3\":   \"75\", \"EXTRAARG4\":   \"\", \"EXTRAARG5\":   \"\", \"EXTRAARG6\":   \"\", \"EXTRAARG7\":   \"\", \"EXTRAARG8\":   \"\", \"EXTRAARG9\":   \"\", \"LEGACYFMT\":   \"01-02-E-02-PKI 20150426 20:59:32 bang: ERROR - Diskusage exceeded (/backup is 99 percent used: Limit is 75 percent)\" }\n{ \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"02\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"E\", \"ERRNO\": \"04\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.483664082\", \"LONGLEVEL\":  \"ERROR\", \"DESCRIPTION\": \"EJBCA : application server unavailable\", \"EXTRAARG1\":   \"\", \"EXTRAARG2\":   \"\", \"EXTRAARG3\":   \"\", \"EXTRAARG4\":   \"\", \"EXTRAARG5\":   \"\", \"EXTRAARG6\":   \"\", \"EXTRAARG7\":   \"\", \"EXTRAARG8\":   \"\", \"EXTRAARG9\":   \"\", \"LEGACYFMT\":   \"02-01-E-04-PKI 20150426 20:59:32 bang: ERROR - EJBCA : application server unavailable\" }\n{ \"FROM\": \"SYSCHECK\", \"SYSCHECK_VERSION\": \"trunk\", \"LOGFMT\": \"JSON-1.0\", \"SCRIPTID\": \"03\", \"SCRIPTINDEX\": \"01\", \"LEVEL\": \"I\", \"ERRNO\": \"02\", \"SYSTEMNAME\": \"PKI\", \"DATE\": \"20150426 20:59:32\", \"HOSTNAME\": \"bang\", \"SEC1970NANO\": \"1430074772.521154236\", \"LONGLEVEL\":  \"INFO\", \"DESCRIPTION\": \"Memory limit ok (Memory is  KB used: Limit is  KB)\", \"EXTRAARG1\":   \"3825580\", \"EXTRAARG2\":   \"13079398\", \"EXTRAARG3\":   \"\", \"EXTRAARG4\":   \"\", \"EXTRAARG5\":   \"\", \"EXTRAARG6\":   \"\", \"EXTRAARG7\":   \"\", \"EXTRAARG8\":   \"\", \"EXTRAARG9\":   \"\", \"LEGACYFMT\":   \"03-01-I-02-PKI 20150426 20:59:32 bang: INFO - Memory limit ok (Memory is 3825580 KB used: Limit is 13079398 KB)\" }\n</code></pre>"},{"location":"output-format/#info-json-format-description","title":"Info - JSON Format description:","text":"<pre><code>{\n   \"FROM\":\"SYSCHECK\",\n   \"SYSCHECK_VERSION\":\"trunk\",\n   \"LOGFMT\":\"JSON-1.0\",\n   \"SCRIPTID\":\"30\",\n   \"SCRIPTINDEX\":\"01\",\n   \"LEVEL\":\"I\",\n   \"ERRNO\":\"01\",\n   \"SYSTEMNAME\":\"PKI\",\n   \"DATE\":\"20150426 20:59:34\",\n   \"HOSTNAME\":\"bang\",\n   \"SEC1970NANO\":\"1430074774.745658970\",\n   \"LONGLEVEL\":\"INFO\",\n   \"DESCRIPTION\":\"Process  is running\",\n   \"EXTRAARG1\":\"apache2\",\n   \"EXTRAARG2\":\"\",\n   \"EXTRAARG3\":\"\",\n   \"EXTRAARG4\":\"\",\n   \"EXTRAARG5\":\"\",\n   \"EXTRAARG6\":\"\",\n   \"EXTRAARG7\":\"\",\n   \"EXTRAARG8\":\"\",\n   \"EXTRAARG9\":\"\",\n   \"LEGACYFMT\":\"30-01-I-01-PKI 20150426 20:59:34 bang: INFO - Process apache2 is running\"\n}\n</code></pre>"},{"location":"output-format/#info-newfmt-syscheck-sample-output","title":"Info - NEWFMT Syscheck Sample output","text":"<pre><code>/opt/syscheck]$ ./console_syscheck.sh\n01-01-I-01-PKI 20140904 09:27:19 hostname: INFO - Diskusage ok (/ is 3 percent used: Limit is 75 percent)\n01-02-I-01-PKI 20140904 09:27:19 hostname: INFO - Diskusage ok (/backup is 43 percent used: Limit is 75 percent)\n01-03-I-01-PKI 20140904 09:27:19 hostname: INFO - Diskusage ok (/var/lib is 4 percent used: Limit is 75 percent)\n01-04-I-01-PKI 20140904 09:27:19 hostname: INFO - Diskusage ok (/var/log is 1 percent used: Limit is 75 percent)\n02-01-I-01-PKI 20140904 09:27:19 hostname: INFO - EJBCA : ALLOK\n03-01-I-02-PKI 20140904 09:27:19 hostname: INFO - Memory limit ok (Memory is 7734720 KB used: Limit is 13054803 KB)\n03-02-I-03-PKI 20140904 09:27:19 hostname: INFO - Swap limit ok (Swap is 279412 KB used: Limit is 21921788 KB)\n06-01-I-01-PKI 20140904 09:27:20 hostname: INFO - PhysicalDiscs is OK       physicaldrive 1I:1:1 (port 1I:box 1:bay 1, SAS, 300 GB, OK)\n06-02-I-01-PKI 20140904 09:27:21 hostname: INFO - PhysicalDiscs is OK       physicaldrive 1I:1:2 (port 1I:box 1:bay 2, SAS, 300 GB, OK)\n06-03-I-01-PKI 20140904 09:27:22 hostname: INFO - PhysicalDiscs is OK       physicaldrive 1I:1:3 (port 1I:box 1:bay 3, SAS, 300 GB, OK)\n06-04-I-01-PKI 20140904 09:27:22 hostname: INFO - PhysicalDiscs is OK       physicaldrive 1I:1:4 (port 1I:box 1:bay 4, SAS, 300 GB, OK)\n06-05-I-03-PKI 20140904 09:27:23 hostname: INFO - LogicalDiscs is OK       logicaldrive 1 (838.1 GB, RAID 5, OK)\n07-01-I-04-PKI 20140904 09:27:24 hostname: INFO - Syslog is running and delivers messages\n09-02-I-03-PKI 20140904 09:27:24 hostname: INFO - Firewall is up and configured properly\n12-01-I-01-PKI 20140904 09:27:24 hostname: INFO - mysql is running\n17-02-I-01-PKI 20140904 09:27:24 hostname: INFO - ntpd is in sync with server: 10.1.1.1\n19-01-I-03-PKI 20140904 09:27:24 hostname: INFO - I'm alive\n20-01-I-01-PKI 20140904 09:27:24 hostname: INFO - No new errors in ejbca server log\n31-01-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of PSU1 is OK\n31-02-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of PSU2 is OK\n31-06-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #1 AMBIENT Current: 25 Limit: 41 (celsius) is OK\n31-10-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #2 CPU#1 Current: 40 Limit: 82 (celsius) is OK\n31-14-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #3 CPU#2 Current: 40 Limit: 82 (celsius) is OK\n31-18-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #4 MEMORY_BD Current: 32 Limit: 87 (celsius) is OK\n31-22-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #5 MEMORY_BD Current: 32 Limit: 87 (celsius) is OK\n31-26-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #6 MEMORY_BD Current: 34 Limit: 87 (celsius) is OK\n31-30-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #7 MEMORY_BD Current: 35 Limit: 87 (celsius) is OK\n31-34-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #8 SYSTEM_BD Current: 41 Limit: 90 (celsius) is OK\n31-38-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #9 SYSTEM_BD Current: 36 Limit: 65 (celsius) is OK\n31-42-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #10 SYSTEM_BD Current: 44 Limit: 90 (celsius) is OK\n31-46-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #11 SYSTEM_BD Current: 33 Limit: 70 (celsius) is OK\n31-50-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #12 SYSTEM_BD Current: 42 Limit: 90 (celsius) is OK\n31-54-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #13 I/O_ZONE Current: 32 Limit: 70 (celsius) is OK\n31-58-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #14 I/O_ZONE Current: 35 Limit: 70 (celsius) is OK\n31-62-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #15 I/O_ZONE Current: 34 Limit: 70 (celsius) is OK\n31-63-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #16 I/O_ZONE is known not to give any reading (#16;I/O_ZONE;-;70C/158F;) is OK\n31-64-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #17 I/O_ZONE is known not to give any reading (#17;I/O_ZONE;-;70C/158F;) is OK\n31-65-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #18 I/O_ZONE is known not to give any reading (#18;I/O_ZONE;-;70C/158F;) is OK\n31-69-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #19 SYSTEM_BD Current: 27 Limit: 70 (celsius) is OK\n31-73-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #20 SYSTEM_BD Current: 30 Limit: 70 (celsius) is OK\n31-77-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #21 SYSTEM_BD Current: 32 Limit: 80 (celsius) is OK\n31-81-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #22 SYSTEM_BD Current: 32 Limit: 80 (celsius) is OK\n31-85-I-01-PKI 20140904 09:27:25 hostname: INFO - Sensor of TEMP #23 SYSTEM_BD Current: 39 Limit: 77 (celsius) is OK\n31-89-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of TEMP #24 SYSTEM_BD Current: 34 Limit: 70 (celsius) is OK\n31-93-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of TEMP #25 SYSTEM_BD Current: 33 Limit: 70 (celsius) is OK\n31-97-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of TEMP #26 SYSTEM_BD Current: 34 Limit: 70 (celsius) is OK\n31-98-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of TEMP #27 I/O_ZONE is known not to give any reading (#27;I/O_ZONE;-;70C/158F;) is OK\n31-99-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of TEMP #28 I/O_ZONE is known not to give any reading (#28;I/O_ZONE;-;70C/158F;) is OK\n31-103-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of TEMP #29 SCSI_BACKPLANE_ZONE Current: 35 Limit: 60 (celsius) is OK\n31-107-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of TEMP #30 SYSTEM_BD Current: 64 Limit: 110 (celsius) is OK\n31-108-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of FAN(#1) IS in normal operation (NORMAL/29%) is OK\n31-109-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of FAN(#2) IS in normal operation (NORMAL/30%) is OK\n31-110-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of FAN(#3) IS in normal operation (NORMAL/35%) is OK\n31-111-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of FAN(#4) IS in normal operation (NORMAL/35%) is OK\n31-112-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of FAN(#5) IS in normal operation (NORMAL/30%) is OK\n31-113-I-01-PKI 20140904 09:27:26 hostname: INFO - Sensor of FAN(#6) IS in normal operation (NORMAL/13%) is OK\n</code></pre>"},{"location":"output-format/#info-newfmt-format-description","title":"Info - NEWFMT Format description:","text":"<pre><code>01-01-I-01-PKI 20140904 09:27:19 hostname: INFO - Diskusage ok (/ is 3 percent used: Limit is 75 percent)\n      I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent)\n      ```\n</code></pre> <ol> <li>ScriptID, unique id for the script, usally 2 numbers byt may be more, use the - as separator</li> <li>\u201d-\u201d Separator</li> <li>ScriptIndex, unique index for the test (eg. 01 for the first disc tested, 02 for the second and so on..), usally 2 numbers byt may be more, use the - as separator</li> <li>\u201d-\u201d Separator</li> <li>ErrorLevel - Can be I for INFO, W for Warning or E for Error</li> <li>\u201d-\u201d Separator</li> <li>Status code, usally 2 numbers byt may be more, use the - as separator</li> <li>\u201d-\u201d Separator</li> <li>System ID</li> <li>\u201d \u201d Separator 12: date and time YYYYMMDD HH:MM:SS</li> <li>Systemname</li> <li>\u201d:\u201d Separator</li> <li>\u201d \u201d Separator</li> <li>Level spelled out</li> <li>\u201d - \u201d Separator 18 - . Message</li> </ol> <pre><code>### Info - OLDFMT Syscheck Sample output\n</code></pre> <p>/opt/syscheck$ ./syscheck.sh -s</p> <pre><code>\n</code></pre> <p>I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent) E-0203-PKI 20090328 22:54:23 plup: ERROR - EJBCA : Application Server is unavailable I-0302-PKI 20090328 22:54:23 plup: INFO - Memory limit ok (Memory is 869492 KB used: Limit is 1613286 KB) I-0303-PKI 20090328 22:54:23 plup: INFO - Swap limit ok (Swap is 18672 KB used: Limit is 2963988 KB) E-0402-PKI 20090328 22:54:24 plup: ERROR - Wrong number of attached pcsc-readers () I-0501-PKI 20090328 22:54:24 plup: INFO - pcscd is running E-0606-PKI 20090328 22:54:24 plup: ERROR - HPTOOL not installed at: /usr/sbin/hpacucli E-0703-PKI 20090328 22:54:24 plup: ERROR - syslog is not running E-0803-PKI 20090328 22:54:25 plup: ERROR - Unable to get CRL http://localhost/crl/eIDCA.crl from webserver E-0901-PKI 20090328 22:54:25 plup: ERROR - Firewall seems to be turned off. E-1102-PKI 20090328 22:54:35 plup: ERROR - heartbeat is NOT running I-1201-PKI 20090328 22:54:35 plup: INFO - mysql is running E-1403-PKI 20090328 22:54:35 plup: ERROR - Unpredicted error in SW-raid 8 / 0 () E-1502-PKI 20090328 22:54:35 plup: ERROR - Apache webserver is not running E-1602-PKI 20090328 22:54:36 plup: ERROR - LDAP directory server is not running E-1703-PKI 20090328 22:54:36 plup: ERROR - ntpd can\u2019t synchronize a server I-1801-PKI 20090328 22:54:36 plup: INFO - mysql is running and answering I-1903-PKI 20090328 22:54:36 plup: INFO - I\u2019m alive</p> <pre><code>### Info - OLDFMT Format description:\n</code></pre> <p>I-0101-PKI 20090328 22:54:23 plup: INFO - Diskusage ok (/ is 51 percent used: Limit is 95 percent)</p> <pre><code>\n</code></pre> <p>With fixed width: 1. \u201cI\u201d - Can be I for INFO, W for Warning or E for Error 2. \u201c-\u201d Separator 3-5. Script ID 6. Status code 7. \u201c-\u201d Separator 8-10. System ID 11. \u201d \u201d Separator 12-28: date and time YYYYMMDD HH:MM:SS</p> <p>With Variable width: 29-32. Systemname 33. \u201c:\u201d Separator 34. \u201d \u201d Separator 35-38. Level spelled out 39-41. \u201d - \u201d Separator 42 - . Message ```</p>"},{"location":"related-scripts/","title":"Syscheck version 2.0","text":"<p>Documentation generated: Mon 10 Aug 00:13:14 CEST 2020</p>"},{"location":"related-scripts/#syscheck-related-scripts","title":"Syscheck related scripts","text":""},{"location":"related-scripts/#900_export_certsh","title":"900_export_cert.sh","text":"<pre><code>Scriptid: 900 - Export certificate file\n\nExport certificate and archive them, ./900_export_cert.sh &lt;certfile&gt;\n\nError code / description - What to do\n\n9001 / Export certificate run successfully - no actions needed\n9002 / Export certificate failed (%s)  - Unexpected, run the script with sh -x to check\n9003 / Export certificate failed, script called without file - call this script with a PEM encoded certficate as arg1\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#901_export_revocationsh","title":"901_export_revocation.sh","text":"<pre><code>Scriptid: 901 - Export CRL file\n\nExport CRL:s with a script ./901_export_revocation.sh &lt;DER-encoded CERT&gt;\n\nError code / description - What to do\n\n9011 / Export revocation run successfully - no actions needed\n9012 / Export revocation failed (%s)  - check manually with sh -x ./901_export_revocation.sh &lt;file&gt;\n9013 / Export revocation failed, script called without file - call this script with a DER encoded CERT as arg1\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#902_export_crlsh","title":"902_export_crl.sh","text":"<pre><code>Scriptid: 902 - Export revoked certificate file\n\nExport CRL ./902_export_crl.sh: &lt;DER encoded CRL&gt;\n\nError code / description - What to do\n\n9021 / Export CRL run successfully - no action needed\n9022 / Export CRL failed (%s)  - check manual with sh -x ./902_export_crl.sh &lt;crl&gt;\n9023 / Export CRL failed, script called without file - arg1 must be a DER encoded crl!\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#903_make_hsm_backupsh","title":"903_make_hsm_backup.sh","text":"<pre><code>Scriptid: 903 - Nfast backup\n\nBackup a HSM\n\nError code / description - What to do\n\n9031 / Backup of Nfast HSM run successfully - no action needed\n9032 / Backup of Nfast HSM failed (%s)  - TODO\n9033 /  - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#904_make_mysql_db_backupsh","title":"904_make_mysql_db_backup.sh","text":"<pre><code>Scriptid: 904 - Mysql backup tool\n\nsyntax: ./904_make_mysql_db_backup.sh [-x|--default|-d|--daily|-w|--weekly|-m|--monthly|-y|--yearly] [-s|--screen] [-b|--batch] \n\n -x and --default will put the backupfile in directory defined in config as SUBDIR_DEFAULT\n -d or --daily will put the backup in the directory defined in config as SUBDIR_DAILY\n -w or --weekly will put the backup in the directory defined in config as SUBDIR_WEEKLY\n -m or --monthly will put the backup in the directory defined in config as SUBDIR_MONTHLY\n -y or --yearly will put the backup in the directory defined in config as SUBDIR_YEARLY\n OBSERVE that it's up to the admin to run this script with cron or alike at these intervals, so run this script once a day with --daily to get only one daily backup and so on\n -b or --batch will echo the resulting filename for processing by other scripts\n\nError code / description - What to do\n\n9041 / Backed up db ok file: %s time to complete(sec): %s filesize(bytes): %s - no action needed\n9042 / Could not create the backup file: %s time to complete(sec): %s filesize(bytes): %s errormess: %s - Run manually also check disk space and owner of directory to write backup to\n9043 / Backup failed, backupdir not found (%s) - check the configfile and make sure the configured directory exist\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#905_publish_crlsh","title":"905_publish_crl.sh","text":"<pre><code>Scriptid: 905 - CRL publish\n\nScript to publish the CRL:s from the CA, supports local and remote publishing by SSH\n\nError code / description - What to do\n\n9051 / Publish CRL run successfully (%s) %s - No action needed\n9052 / Publish to remote host failed crl:(%s) host:(%s) - Try manually to run this command and setup ssh-keys and check username\n9053 / Publish CRL failed, can't copy crl to destination %s/%s - Check permissions for the path:s\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#906_ssh-copy-to-remote-machinesh","title":"906_ssh-copy-to-remote-machine.sh","text":"<pre><code>Scriptid: 906 - SCP support tool\n\nScript used to copy files to other hosts/directorys usage: ./906_ssh-copy-to-remote-machine.sh: file host &lt;directory&gt; &lt;to-username&gt; &lt;from-ssh-key&gt; \n(if you dont specify directory the file will end up in the user's homedirectory, \nif you dont specify to-username the same user as the one executing this script will be used, \nif from-ssh-key is not specified default key will be used)\n\nError code / description - What to do\n\n9061 / file transfered ok - ok\n9062 / specify a filename as first argument to this script - filename not specified as argument\n9063 / specify a hostname as second argument to this script - Hostname not specified as argument\n9064 / scp failed: %s - check the error message and try to fix it\n9065 / Diskspace at host: %s and dir: %s has to little space left %s , its lower than %s of the file: %s - Disk space on remote host to low\n9066 / Remote filesize at host: %s and dir: %s has different size: %s than the original: %s of the file: %s - Remote filesize after transfer differs\n9067 / Remote file already exist at host: %s remote file: %s for the local file: %s - Remote file already exist\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#907_make_mysql_db_backup_and_transfer_to_remote_mashinesh","title":"907_make_mysql_db_backup_and_transfer_to_remote_mashine.sh","text":"<pre><code>Scriptid: 907 - Mariadb backup and transfer to remote host\n\nScript used to take backup of the sql database, compress and send to a separate server. call with -x|--default for puting the backupfile in the SUBDIR_DEFAULT ; -d|--daily to make daily backup end up in SUBDIR_DAILY; with -w|--weekly to make daily backup end up in SUBDIR_WEEKLY; -m|--monthly to make daily backup end up in SUBDIR_MONTHLY ; -y|--yearly to make daily backup end up in SUBDIR_YEARLY;\n\nError code / description - What to do\n\n9071 / Backup and transfer was ok. - Ok\n9072 / Could not get the backup from MySQL (%s)  - Could not make a backup.\n9073 / Could not send the backup, maybe connection problem or problem logging in (%s)  - Could not send the backup.\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#908_clean_old_backupssh","title":"908_clean_old_backups.sh","text":"<pre><code>Scriptid: 908 - Clean old backup files\n\nClean old backups, so the disk dont fill up\n\nError code / description - What to do\n\n9081 / Clean backupfiles run successfully - All is ok\n9082 / Clean backupfiles failed (%s)  - Unpredicted error while deleting file %s\n9083 / Clean backupfile file did not exist (%s)  - Maybe the files has been already removed or there was no files from start\n9084 / Datestring command did NOT return a valid string - try to run source lib/libsyscheck.sh ; x-days-ago-datestr 3 \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#909_activate_cassh","title":"909_activate_CAs.sh","text":"<pre><code>Scriptid: 909 - Activate CA HSM\n\nActivate the CA:s (automaticlly enter PIN codes)\n\nError code / description - What to do\n\n9091 / Activate CA:s run successfully - All is ok\n9092 / Activate CA failed (%s/%s) - Could be problems accessing the application server, or token is not available  %s\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#910_deactivate_cassh","title":"910_deactivate_CAs.sh","text":"<pre><code>Scriptid: 910 - Deactivate CA HSM\n\nDeactivate the CA:s\n\nError code / description - What to do\n\n9101 / Deactivate CA:s run successfully - All is ok\n9102 / Deactivate CA failed (%s)  - Could be problems accessing the application server, or token is not available  %s\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#911_activate_vipsh","title":"911_activate_VIP.sh","text":"<pre><code>Scriptid: 911 - Activate VIP\n\nActivate the VIP\n\nError code / description - What to do\n\n9111 / Activate VIP run successfully - All is ok\n9112 / Activate VIP failed (%s)  - Manually try the ipconfig commands error:(%s)\n9113 / Activate VIP failed since the VIP was already active - All is ok, if the VIP was supposed to be on this host already\n9114 / Activate VIP failed since the VIP was already active on another node - Check the other node to see if that node has the VIP, else start invesigating who has you IP ...\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#912_deactivate_vipsh","title":"912_deactivate_VIP.sh","text":"<pre><code>Scriptid: 912 - Deactivate VIP\n\nDeactivate the VIP\n\nError code / description - What to do\n\n9121 / Deactivate VIP run successfully - All is ok\n9122 / Deactivate VIP failed (%s)  - Check manually with ifconfig -a and run ifconfig &lt;if&gt; down\n9123 / While deactivating, the VIP was already NOT active on this host - If the VIP was supposed to be at this host this event needs investigation \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#913_copy_ejbca_confsh","title":"913_copy_ejbca_conf.sh","text":"<pre><code>Scriptid: 913 - Copy config to NODE2\n\nCopy EJBCA conf/, p12/ and syscheck\n\nError code / description - What to do\n\n9131 / Copy run successfully - Check config and keys to remote hosts\n9132 / Copy failed (%s)  - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#914_compare_master_slave_dbsh","title":"914_compare_master_slave_db.sh","text":"<pre><code>Scriptid: 914 - Deactivate VIP\n\nCompare tables on master and slave database\n\nError code / description - What to do\n\n9141 / Data read successfully - All is ok\n9142 / Could not get table data - Check connection, username and password\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#915_remote_command_via_sshsh","title":"915_remote_command_via_ssh.sh","text":"<pre><code>Scriptid: 915 - SSH remote command tool\n\nRun command on another host with ssh ./915_remote_command_via_ssh.sh --host host --command cmd --user sshtouser --key sshfromkey\n\nError code / description - What to do\n\n9151 / Command executed successfully (%s) - All is ok\n9152 / Host not found (%s) - You have to specify a hostname to connect to\n9153 / Command not found (%s) - Specify a command to run\n9154 / Command not executed (%s) - Check connection, username and password\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#916_archive_access_manager_logssh","title":"916_archive_access_manager_logs.sh","text":"<pre><code>Scriptid: 916 - Archive log files\n\nScript used to move/archive logfiles\n\nError code / description - What to do\n\n9161 / Files archived succefully (%s -&gt; %s) - ok\n9162 / Failed to artchive files (%s -&gt; %s) - test the underlying archive script manually\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#917_archive_filesh","title":"917_archive_file.sh","text":"<pre><code>Scriptid: 917 - Archive files\n\nScript used to copy files to other hosts/directorys usage: ./917_archive_file.sh: file host &lt;directory&gt; &lt;to-username&gt; &lt;from-ssh-key&gt; \n(if you dont specify directory the file will end up in the user's homedirectory, \nif you dont specify to-username the same user as the one executing this script will be used, \nif from-ssh-key is not specified default key will be used)\n\nError code / description - What to do\n\n9171 / File archived succefully Locally (%s -&gt; %s) - ok\n9172 / Failed to move file to Local archive (%s -&gt; %s) - Check write premisions in archive dir\n9173 / Errornous input arguments - specify the right arguments (run ./917_archive_file.sh -h for help)\n9174 / Failed to get a filename from remote server - Check ssh connection setup to remote server\n9175 / File Failed to be Archived on Remote Server (%s) - Check ssh connection setup to remote server and write permissions in remote archive dir\n9176 / File Archived successfully to Remote Server (%s) - ok\n9177 / File moved successfully to intransit folder (%s -&gt; %s) - ok\n9178 / Failed to create file in the intransit folder (%s) - Check permissions to write in the intransit folder\n9179 / Intransit dir not found - Create the dir with mkdir\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#918_server_alivesh","title":"918_server_alive.sh","text":"<pre><code>Scriptid: 918 - Passive server monitoring\n\nPassive server monitoring, all server that should be monitored should be listed in 918.conf and run sc_19.sh every x:th minute, example: if you run syscheck every 10:th minute set warn to 15(missed one log and some margin) and error to 25(missed one log and some margin)\n\nError code / description - What to do\n\n9181 / machine(%s) has called in as it's supposed to (lastcall: %s). - no action is needed\n9182 / machine(%s) has not called in within error limit (lastcall: %s) - two missed log messages, this needs attention\n9183 / machine(%s) has not called in within warn limit (lastcall: %s) - one missed log message, may be a glitch but should be checked\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#919_certpublisher_remotecommandsh","title":"919_certpublisher_remotecommand.sh","text":"<pre><code>Scriptid: 919 - Certificate publishing remote host\n\nTakes a certificate and runs a configurable command at a remote host\n\nError code / description - What to do\n\n9191 / Remote command ran successfully (%s) - no action needed\n9192 / Remote command failed (%s) - try to run the command manually\n9193 / File input error, failed (%s) - input file not set ok\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#920_restore_mysql_db_from_backupsh","title":"920_restore_mysql_db_from_backup.sh","text":"<pre><code>Scriptid: 920 - DB Restore tool\n\nRestore db, syntax: ./920_restore_mysql_db_from_backup.sh &lt;gzip:ed mysqldump-file&gt;\n\nError code / description - What to do\n\n9201 / Failed to make backup of the pre-existing db prior to restore - run a manual backup with arg -s to check errors\n9202 / Restored the db from file (%s) - no action needed\n9203 / Failed to restore the db from the file (%s) consider to restore to previously db (%s) - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#921_copy_htmf_confsh","title":"921_copy_htmf_conf.sh","text":"<pre><code>Scriptid: 921 - Copy HTMF config\n\nCopy HTMF config\n\nError code / description - What to do\n\n9211 / Interactive script to copy htmf / ejbca config - files are added in config file\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#922-simple-database-replication-checksh","title":"922-simple-database-replication-check.sh","text":"<pre><code>Scriptid: 922 - Simple db replication tool\n\nSimple replication test\n\nError code / description - What to do\n\n9221 / Value replicated ok - ok, no action needed\n9222 / Value differs - databse not replicating (%s != %s), manually check the database with check master and check slave script\n9223 / No value from node2 (%s) - check connection manually, ping, telnet, mysql -h node2 -u dbadmin -p ... \n9224 / No value from node1 (%s) - check connection manually, ping, telnet, mysql -h node1 -u dbadmin -p ... \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#923-rsync-to-remote-machinesh","title":"923-rsync-to-remote-machine.sh","text":"<pre><code>Scriptid: 923 - Sync files to remote host\n\nScript used to sync files with rsync to other hosts/directorys usage: ./923-rsync-to-remote-machine.sh: file host &lt;directory&gt; &lt;to-username&gt; &lt;from-ssh-key&gt; \n(if you dont specify directory the file will end up in the user's homedirectory, \nif you dont specify to-username the same user as the one executing this script will be used, \nif from-ssh-key is not specified default key will be used)\n\nError code / description - What to do\n\n9231 / file transfered ok - ok\n9232 / specify a filename as first argument to this script - filename not specified as argument\n9233 / specify a hostname as second argument to this script - Hostname not specified as argument\n9234 / rsync  transfer failed (%s) - check the error message and try to fix it\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#924-backup-this-machine-to-remote-machinesh","title":"924-backup-this-machine-to-remote-machine.sh","text":"<pre><code>Scriptid: 924 - Sync several directories and files to remote host\n\nScript used to rsync configured files/dirs to other hosts\n\nError code / description - What to do\n\n9241 / file transfered ok - ok\n9242 / Could not find transfer script - The underlying script for making the transfers SYSCHECK_HOME/related-enabled/923-rsync-to-remote-machine.sh dont exist, read docs for guide howto enable it\n9243 / Failed to sync files (%s) - check the config and run SYSCHECK_HOME/related-enabled/923-rsync-to-remote-machine.sh manually with the same options\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#925_publish_crl_from_filesh","title":"925_publish_crl_from_file.sh","text":"<pre><code>Scriptid: 925 - Publish a CRL from a file\n\nPublish a CRL from file, ie you need to call this script with the file on disc\n./925_publish_crl_from_file.sh: -c &lt;file&gt;|--crlfile=&lt;file&gt;\n\nError code / description - What to do\n\n9251 / Publish crl run successfully - ok\n9252 / no input file found - supply file as argument to this script\n9253 / Publish certificate failed, cant read file (%s) - verify the file is in place and with proper permissions before executing this script\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#926_local_htmf_copy_confsh","title":"926_local_htmf_copy_conf.sh","text":"<pre><code>Scriptid: 926 - Locally copy config and keystores\n\nCopy all config/keystore files to /tmp/bckup_htmf_conf before system upgrade\n\nError code / description - What to do\n\n9261 / File copied ok(%s) - no action needed\n9262 / Failed to copy file (%s) - check permissions and paths\n9263 / Failed to create backup dir (%s) - check permissions and paths\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#927_create_crlssh","title":"927_create_crls.sh","text":"<pre><code>Scriptid: 927 - Trigger the Creation of CRLs in EJBCA\n\nScript to create the CRL:s from the CA:s options if needed\n\nError code / description - What to do\n\n9271 / Create CRL run successfully (%s) - No action needed\n9272 / Create CRL failed (%s) - Try manually to run this command or direct do 'cd /opt/ejbca ; ./bin/ejbca.sh ca createcrl'\n9273 /  - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#928_check_dsm_backupsh","title":"928_check_dsm_backup.sh","text":"<pre><code>Scriptid: 928 - DSM Backup\n\nCheck if DSM Backup working\n\nError code / description - What to do\n\n9281 / DSM Backup ok (file:%s result:%s) - no action needed\n9282 / DSM Backup failed file:%s result:%s - Check DSM tool for troubleshooting\n9283 /  - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#929_filter_syscheck_messagessh","title":"929_filter_syscheck_messages.sh","text":"<pre><code>Scriptid: 929 - Filter messages from syscheck\n\nFilter only some messages from a file\n\nError code / description - What to do\n\n9291 / Filter ok - no action needed\n9292 / Filter failed - try the commands manually\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#930_send_filtered_result_to_remote_machinesh","title":"930_send_filtered_result_to_remote_machine.sh","text":"<pre><code>Scriptid: 930 - Send files to remote host\n\nCopy a file over to a central hub (might be used to expose some or all of syscheck results)\n\nError code / description - What to do\n\n9301 / Transfer ok (file:%s result:%s) - no action needed\n9302 / Could not transfer file:%s result:%s - try the transfer commands manually\n9303 /  - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#931_mysql_backup_encrypt_send_to_remote_hostsh","title":"931_mysql_backup_encrypt_send_to_remote_host.sh","text":"<pre><code>Scriptid: 931 - Backup, encrypt backup and send to remote hosts\n\nScript used to take backup of the sql database, compress and send to a separate server. call with -x|--default for puting the backupfile in the SUBDIR_DEFAULT ; -d|--daily to make daily backup end up in SUBDIR_DAILY; with -w|--weekly to make daily backup end up in SUBDIR_WEEKLY; -m|--monthly to make daily backup end up in SUBDIR_MONTHLY ; -y|--yearly to make daily backup end up in SUBDIR_YEARLY;\n\nError code / description - What to do\n\n9311 / Backup and transfer was ok. (%s) - Ok\n9312 / Could not get the backup from MySQL (%s)  - Could not make a backup.\n9313 / Compression of the backup failed (%s)  - Could not compress the backup.\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#932_send_result_as_messagesh","title":"932_send_result_as_message.sh","text":"<pre><code>Scriptid: 932 - Send result as a message\n\nSend syscheck result as a message over to a central hub \n\nError code / description - What to do\n\n9321 / Transfer ok (command:%s result:%s) - no action needed\n9322 / Could not send message: %s result:%s - try the transfer commands manually\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#933_select_from_databasesh","title":"933_select_from_database.sh","text":"<pre><code>Scriptid: 933 - Select from db for info\n\nGet info from db\n\nError code / description - What to do\n\n9331 / Selected info from DB (command:%s) - no action needed\n9332 / Could not get info from db: %s - try the commands manually\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#934_check_validity_of_installed_certssh","title":"934_check_validity_of_installed_certs.sh","text":"<pre><code>Scriptid: 934 - Certificate validity check\n\nMonitor certificates validity\n\nError code / description - What to do\n\n9341 / File: %s subj: %s days until expiry: %s - no action needed\n9342 / File: %s subj: %s days until expiry: %s - schedule replacement soon\n9343 / File: %s subj: %s days until expiry: %s - Certificate indicent is close\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#935_mysql_console_as_rootsh","title":"935_mysql_console_as_root.sh","text":"<pre><code>Scriptid: 935 - Start mysql as root\n\nas a convenience tool\n\nError code / description - What to do\n\n9351 /  - \n9352 /  - \n9353 /  - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#936_mysql_console_as_db_usersh","title":"936_mysql_console_as_db_user.sh","text":"<pre><code>Scriptid: 936 - Start mysql as dbuser\n\nas a convenience tool\n\nError code / description - What to do\n\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"related-scripts/#937_delete_old_crldatash","title":"937_delete_old_CRLData.sh","text":"<pre><code>Scriptid: 937 - Delete old records from CRL Data\n\nDelete records from crldata, keep default 20 record in crltable, see config file 817.conf\n\nError code / description - What to do\n\n9371 / No Value in ROW_SAVE - Check scripts config file \n9372 / The value is less then 5 - Check  scripts config file \n9373 / Can't make a backup - Check permisson and dbuser\n9374 / Can't get uniq issuerDN from CRLData  - Check database and logs \n9375 / Can't copy CRLData to db crldata.CRLDatalog for each issuerDN  - Check database and logs \n9376 / Cant delete record from CRLData for uniq issuerDN - Check database and logs \n9377 / Delete to crlnumber  - Delet ok \n9378 / Can't Optimize table  - Check vendor of database, and adjust command \n9379 / Can't zip dbbackup  - Check permission  \n93710 / Delete to crlnumber, restart jboss and check sync  - Delete ok \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"ssh-keys-setup/","title":"Syscheck - LOGBOOK Tool","text":""},{"location":"ssh-keys-setup/#changes","title":"Changes","text":"Version Author Date Comment 1.0 Henrik Andreasson 2016-11-27 Initial version 1.1 Henrik Andreasson 2020-07-31 mkdocs updates"},{"location":"ssh-keys-setup/#ssh-keys-installation","title":"SSH Keys Installation","text":"<p>This chapter assumes that your application user is called \u201cjboss\u201d. The purpose of the installation of ssh-keys is to automaticly be able to run commands on the other node in a cluster.</p> <p>3.1  Generate keys on both nodes on node1 run:</p> <pre><code>username@smartcard20-node1:/usr/local&gt; sudo su  - jboss\njobss@smartcard20-node1:~&gt; ssh-keygen\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/jboss/.ssh/id_rsa):\nCreated directory '/home/jboss/.ssh'.\nEnter passphrase (empty for no passphrase): (press enter to use no passphrase)\nEnter same passphrase again:\nYour identification has been saved in /home/jboss/.ssh/id_rsa.\nYour public key has been saved in /home/jboss/.ssh/id_rsa.pub.\n</code></pre> <p>And also on all the other nodes run:</p> <pre><code>username@smartcard20-node2:/usr/local&gt; sudo su  - jboss\njobss@smartcard20-node2:~&gt; ssh-keygen\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/jboss/.ssh/id_rsa):\nCreated directory '/home/jboss/.ssh'.\nEnter passphrase (empty for no passphrase): (press enter to use no passphrase)\nEnter same passphrase again:\nYour identification has been saved in /home/jboss/.ssh/id_rsa.\nYour public key has been saved in /home/jboss/.ssh/id_rsa.pub.\n</code></pre> <p>Add the own public key to the own authorized_keys to allow local ssh</p> <pre><code>jboss@smartcard20-node1:~&gt; cp .ssh/id_rsa.pub  .ssh/authorized_keys\njboss@smartcard20-node1:~&gt; ssh localhost\nThe authenticity of host 'localhost (127.0.0.1)' can't be established.\nRSA key fingerprint is 73:c8:8f:20:73:83:62:c7:5e:a0:7d:cb:38:c8:04:43.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added 'localhost' (RSA) to the list of known hosts.\njboss@smartcard20-node1:~&gt; logout\non node2 run:\njboss@smartcard20-node2:~&gt; cp .ssh/id_rsa.pub  .ssh/authorized_keys\njboss@smartcard20-node2:~&gt; ssh localhost\nThe authenticity of host 'localhost (127.0.0.1)' can't be established.\nRSA key fingerprint is 73:c8:8f:20:73:83:62:c7:5e:a0:7d:cb:38:c8:04:43.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added 'localhost' (RSA) to the list of known hosts.\njboss@smartcard20-node2:~&gt; logout\n</code></pre> <p>Add node1 public key to node2 authorized_keys to allow ssh from node1 to node2</p> <p>on node1 run:</p> <pre><code>jboss@smartcard20-node1:~&gt; cat .ssh/id_rsa.pub\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1\n</code></pre> <p>on node2 run:</p> <pre><code>jboss@smartcard20-node2:~&gt; vi .ssh/authorized_keys\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2\n</code></pre> <p>To add a new line below the only line in authorized_keys press \u201co\u201d then paste the key from node1 press escape to exit edit mode make sure that the new key is on one line only, press \u201cJ\u201d to join to lines if the line broke in copy-and-paste, delete space with \u201cx\u201d press :wq to exit</p> <p>Change the window size so any line-wraps problem reveals it self. Make sure each key is on one line on node2 run:</p> <pre><code>jboss@smartcard20-node2:~&gt; cat  .ssh/authorized_keys\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArzafoK1mzu0WYr1c0I8efdkOE5+58ccM83fJ32EuUxKfrvEi3GsJKyZPvuSZr4VXUgRvyyWzg8JtwJR7s+8NSqcHhdeN+zeVQx9/YCw8xOQLx9SOORato76WfwhjM7kUrZd/bIQQGRDwh1rvCVRlNr7kFFRsEe+afxP42AZkZaD6bCBsG4BF/iR5+YCERzuUymrN5g8qWU5Hw1Hegedz+7oCJZ8FO3UVB6SREDA1n4c651gWa+xtx+5KgWLcfQU8V019fzuVz45c1mF0r0zQF4Z66gq/HEkYUjttk7hgCrRaeIR1GTu+9HNF2+aSV44ZqKtd5L1cX1xsxJCJijjnSw== han@smartcard20-node1\njboss@smartcard20-node2:~&gt; wc -l  .ssh/authorized_keys\n2 .ssh/authorized_keys\n</code></pre> <p>verify ssh access to the other node:</p> <pre><code>jboss@smartcard20-node1:~&gt; ssh jboss@smartcard20-node2\nLast login: Sat Jun  5 08:41:53 2010 from localhost\njboss@smartcard20-node2:~&gt;\n</code></pre> <p>Add node2 public key to node1 authorized_keys to allow ssh from node2 to node1</p> <p>on node2 run:</p> <pre><code>jboss@smartcard20-node2:~&gt; cat .ssh/id_rsa.pub\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node2\n</code></pre> <p>on node1 run:</p> <pre><code>jboss@smartcard20-node1:~&gt; vi .ssh/authorized_keys\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1\n</code></pre> <p>To add a new line below the only line in authorized_keys press \u201co\u201d then paste the key from node2 press escape to exit edit mode make sure that the new key is on one line only, press \u201cJ\u201d to join to lines if the line broke in copy-and-paste, delete space with \u201cx\u201d press :wq to exit</p> <p>Change the window size so any line-wraps problem reveals it self. Make sure each key is on one line on node2 run:</p> <pre><code>jboss@smartcard20-node1:~&gt; cat  .ssh/authorized_keys\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAqAxIMkP3or7xGr/PTSpomW+zUh9Id5yL6GKhaoctgI1wJtM7wbiQhq4V6VXmL2onHIKDAJTJ+A10qzy8+iolCmAjnHbVw+Xy3YhPbQuT21dvntTuXtv+4xMgeAagbAg6hRI+3qcidmLkQGsSvJncJkJ/vftcw0e0rbRToDEiS3jbK6VFBo+k3mccBlPG3KqlvM6YoHajoAkxU11IIWY+sesnsfOPMjwt7bfXqT32XBNzIpAwBIJVQ0cBIs+Sz551hR5ERvWW9Qp8nl4hcEwVSrsiflyGJKxI7AnMxzaIJdfoBsZTj/jUtDpK/PnGuJzNMkwQlSmdCND+N2QW7n9WxQ== jboss@smartcard20-node1\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArzafoK1mzu0WYr1c0I8efdkOE5+58ccM83fJ32EuUxKfrvEi3GsJKyZPvuSZr4VXUgRvyyWzg8JtwJR7s+8NSqcHhdeN+zeVQx9/YCw8xOQLx9SOORato76WfwhjM7kUrZd/bIQQGRDwh1rvCVRlNr7kFFRsEe+afxP42AZkZaD6bCBsG4BF/iR5+YCERzuUymrN5g8qWU5Hw1Hegedz+7oCJZ8FO3UVB6SREDA1n4c651gWa+xtx+5KgWLcfQU8V019fzuVz45c1mF0r0zQF4Z66gq/HEkYUjttk7hgCrRaeIR1GTu+9HNF2+aSV44ZqKtd5L1cX1xsxJCJijjnSw== han@smartcard20-node2\njboss@smartcard20-node2:~&gt; wc -l  .ssh/authorized_keys\n2 .ssh/authorized_keys\n</code></pre> <p>verify ssh access to the other node:</p> <pre><code>jboss@smartcard20-node2:~&gt; ssh smartcard20-node1\nLast login: Sat Jun  5 08:41:53 2010 from localhost\njboss@smartcard20-node1:~&gt;\n</code></pre>"},{"location":"syscheck-scripts/","title":"Syscheck version 2.0","text":"<p>Documentation generated: Mon 10 Aug 00:16:11 CEST 2020</p>"},{"location":"syscheck-scripts/#syscheck-scripts","title":"Syscheck scripts","text":""},{"location":"syscheck-scripts/#sc_01_diskusagesh","title":"sc_01_diskusage.sh","text":"<pre><code>Scriptid: 01 - Disk usage\n\nsc_01_diskusage.sh Script that checks for to much hard-disc usage, limit is:\n\nError code / description - What to do\n\n011 / Diskusage ok (%s is %s percent used: Limit is %s percent) - No action is needed\n012 / Diskusage exceeded (%s is %s percent used: Limit is %s percent) - The usage is more than the limit, if the disk fills up thing will start to break, make some free space and maybe restart the machine\n013 / Diskusage problems (%s : %s) - Manually check config and also try df -Ph /path\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_02_ejbcash","title":"sc_02_ejbca.sh","text":"<pre><code>Scriptid: 02 - EJBCA Health check\n\nsc_02_ejbca.sh Script that connects to the ejbca health check servlet to check the status of the ejbca application. The health check servlet checks JVM memory, database connection and HSM connection.\n\nError code / description - What to do\n\n021 / EJBCA : %s - No action is needed\n022 / EJBCA : %s - Possible errors: \n\"Error Virtual Memory is about to run out, currently free memory : X\" - you need to add more virtual memory to application server/java process\n\"Error Connecting to EJBCA Database\" - The internal check of database failed, try to connect to database directly or restart database server\n\"CA Token is disconnected\" - activate token or maybe a restart of pcscd can help\n023 / EJBCA : health check tool failure - The tool to check if EJBCA is at good health is not configured properly\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_03_memory-usagesh","title":"sc_03_memory-usage.sh","text":"<pre><code>Scriptid: 03 - Memory usage\n\nsc_03_memory-usage.sh Script that checks that there is enough free memory. The limit is configured in the script, limit: \n\nError code / description - What to do\n\n031 / Memory limit exceded (Memory is %s KB used: Limit is %s KB) - system currently uses more than the configured limit, this can be a warning, but can also be a sign of a hard workning system without errors\n032 / Memory limit ok (Memory is %s KB used: Limit is %s KB) - system currently uses below the limit\n033 / Swap limit exceded (Swap is %s KB used: Limit is %s KB) - system uses more than the swap limit and if the usage dont drop soon you need to investigate, system WILL crash if it runs out of swap compleatly\n034 / Swap limit ok (Swap is %s KB used: Limit is %s KB) - No action is needed\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_04_pcsc_readerssh","title":"sc_04_pcsc_readers.sh","text":"<pre><code>Scriptid: 04 - Connected PCSC Readers\n\nchecks for the defined number of PCSC readers is attached to the computer\n\nError code / description - What to do\n\n041 / Right number of attatched pcsc-readers (%s) - No action is needed\n042 / Wrong number of attached pcsc-readers current: (%s) should be: (%s) - means that all reader is NOT working correctly as defined by pcscd\n043 / module not installed(%s) - means that you've not installed the module used by this script python pyscard\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_05_pcscdsh","title":"sc_05_pcscd.sh","text":"<pre><code>Scriptid: 05 - pcscd is running\n\ncheck that pcscd is running\n\nError code / description - What to do\n\n051 / pcscd is running - No action is needed\n052 / pcscd is NOT running - pcscd needs to be restarted, if it dont start, run it with: /path/to/pcscd --foreground --debug\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_06_raid_checksh","title":"sc_06_raid_check.sh","text":"<pre><code>Scriptid: 06 - HP Raid check\n\ncheck the raid discs\n\nError code / description - What to do\n\n061 / PhysicalDiscs is OK %s - No action is needed\n062 / PhysicalDiscs is not OK %s - Change disc as soon as possible\n063 / LogicalDiscs is OK %s - No action is needed\n064 / LogicalDiscs is rebuilding %s - check back in a while to see this error goes away, else you need to investigate\n065 / LogicalDiscs has some other error %s - you need to investigate this error ASAP\n066 / HPTOOL not installed at: %s - the hptool is not installed, install the tool to get working reports\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_07_syslogsh","title":"sc_07_syslog.sh","text":"<pre><code>Scriptid: 07 - Check if syslog if running\n\ncheck to see that syslog is running and delivers messages ok\n\nError code / description - What to do\n\n071 / loggmessage did not come throu SYSLOG - syslog is running but the messages dont comes throu to local file, restart and/or check config file\n072 / syslog is not running - the process was not found amoung running processes\n073 / Syslog is running and delivers messages - No action is needed\n074 /  - \n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_08_crl_from_webserversh","title":"sc_08_crl_from_webserver.sh","text":"<pre><code>Scriptid: 08 - Download CRL from Webserver and check its validity\n\ncheck the status of CRL, both that it can be downloaded and that its valid\n\nError code / description - What to do\n\n081 / CRL %s creation have failed - either the server is not up, it dont produce CRL:s, it dont validate or the CRL is old \n082 / %s - No action is needed\n083 / Unable to get CRL %s from webserver  - Check manually to get CRL from webserver\n084 / When getting CRL %s the size of file is 0 - Check discusage, try manually to get CRL\n085 / Configuration error: %s - Check config\n086 / CRL has past the EXPIRE date: %s - Systems will probably fail due to this, urgent troubleshooting needed\n087 / CRL has past the ERROR level: %s - Systems will soon fail if not fixed, urgent troubleshooting needed\n088 / CRL has past the WARN level: %s - Systems will soon fail if not fixed, urgent troubleshooting needed\n089 / CRL summary problems: %s - Systems will soon fail if not fixed, urgent troubleshooting needed\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_09_firewallsh","title":"sc_09_firewall.sh","text":"<pre><code>Scriptid: 09 - Firewall iptables\n\nCheck the firewall is configured and running\n\nError code / description - What to do\n\n091 / Cant get status from iptables. - check manually with iptables -L -n or maybe restart the firewall with /etc/init.d/firewall start\n092 / Firewall doesn't seem to have the correct ruleset configured. - Maybe something went wrong loading the firewall ruleset, because some very basic rules are'nt present \n093 / Firewall is up and configured properly - No action is needed\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_10_ocspsh","title":"sc_10_ocsp.sh","text":"<pre><code>Scriptid: 10 - Query OCSP Responder\n\nall ok\n\nError code / description - What to do\n\n101 / Responder cert calculation failed (%s) - either the server is not up, it don't produce OCSP Responses:s\n102 / Responder cert ok: %s minutes remains: %s - No action is needed\n103 / Responder cert has passed validity warning level %s : %s - Schedule a update of Responder cert\n104 / Responder cert has passed validity ERROR level %s : %s - Urgently replace the OCSP responder certificate\n105 / Responder cert has PASSED EXPIRY date %s : %s - Urgently replace the OCSP responder certificate\n106 / Response status ok: %s - this ocsp response is ok\n107 / OCSP Summary ERROR msg: %s errors: %s warnings: %s - search for 10 in logs for more detailed info or run syscheck manually\n108 / OCSP Summary WARNING msg: %s errors: %s warnings: %s - search for 10 in logs for more detailed info or run syscheck manually\n109 / OCSP Summary OK - this ocsp summary is ok\n1010 / OCSP response not ok %s - ocsp response not ok\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_12_mysqlsh","title":"sc_12_mysql.sh","text":"<pre><code>Scriptid: 12 - Mysql server\n\nMysql server checks\n\nError code / description - What to do\n\n121 / mysql is running - No action is needed\n122 / mysql is NOT running - mysql is not running, try /etc/init.d/mysql stop, wait, /etc/init.d/mysql start\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_14_sw_raidsh","title":"sc_14_sw_raid.sh","text":"<pre><code>Scriptid: 14 - SW Raid\n\nLinux software raid checks\n\nError code / description - What to do\n\n141 / Disc Array is OK %s - means this script has not detected any errors\n142 / Disc %s is failed in array: %s - A disk has failed, you need to replace it\n143 / Unpredicted error in SW-raid %s - this script has found a not prediced error\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_15_apachesh","title":"sc_15_apache.sh","text":"<pre><code>Scriptid: 15 - Apache Web server\n\nCheck apache process is up and running\n\nError code / description - What to do\n\n151 / Apache webserver is running - server is running and serving web pages\n152 / Apache webserver is not running - check apache error.log, it is not running\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_16_ldapsh","title":"sc_16_ldap.sh","text":"<pre><code>Scriptid: 16 - LDAP Server\n\nChecks the ldap server to make sure it's running\n\nError code / description - What to do\n\n161 / LDAP directory server is running - all ok\n162 / LDAP directory server is not running - check you ldap server logs\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_17_ntpsh","title":"sc_17_ntp.sh","text":"<pre><code>Scriptid: 17 - NTP in sync\n\nCheck that ntp i running and is insync\n\nError code / description - What to do\n\n171 / ntpd is in sync with server: %s - all ok\n172 / ntpd is NOT running. - Start it with /etc/init.d/xntpd start\n173 / cant check ntp sync to: %s - check the configuration or restart ntpd\n174 / ntpd can NOT synchronize to servers LOCAL(0) mode  - Check network connectivity and configuration of ntp\n175 / ntp server not sent in input - Check your syscheck config for ntp\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_18_sqlselectsh","title":"sc_18_sqlselect.sh","text":"<pre><code>Scriptid: 18 - Mysql Select\n\nMysql select keepalive\n\nError code / description - What to do\n\n181 / mysql is running and answering - No action is needed\n182 / mysql is NOT answering to select statement check - mysql is not running, try /etc/init.d/mysql stop, wait, /etc/init.d/mysql start\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_19_alivesh","title":"sc_19_alive.sh","text":"<pre><code>Scriptid: 19 - Server is alive\n\nSends alive messages to a central syscheck server run this script either along with the rest of the syscheck scripts or in a crontab (then you can run me more often...)\n\nError code / description - What to do\n\n191 / Operating system just started - Message is sent when the server's operating system is started\n192 / Operating system is shutting down - Message is sent when the server's operating system is shutdown\n193 / I'm alive - Message is sent to make sure central server know's this server is alive\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_20_errors_ejbcalogsh","title":"sc_20_errors_ejbcalog.sh","text":"<pre><code>Scriptid: 20 - EJBCA Error log checker\n\nchecks fo new errors in the server log for ejbca\n\nError code / description - What to do\n\n201 / No new errors in ejbca server log - No action is needed\n202 / New error in log: %s - There was new ERRORS in the LOG file, please attend to them\n203 / Cant find the specified ejbca log %s - maybe you havnt configured the script yet?\n204 / New detailed error in log: %s - There was new ERRORS in the LOG file, please attend to them\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_22_boks_replicash","title":"sc_22_boks_replica.sh","text":"<pre><code>Scriptid: 22 - BOKS\n\nBoKS Replica checks\n\nError code / description - What to do\n\n221 / No action is needed - all boks processes are running\n222 / All BoKS replica processes IS NOT running %s - Not all boks processes are running\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_23_rsa_axmsh","title":"sc_23_rsa_axm.sh","text":"<pre><code>Scriptid: 23 - RSA Access Manager\n\nChecks the RSA Access Manager server to make sure it's running\n\nError code / description - What to do\n\n231 / RSA Access Manager is running - all ok\n232 / At least one service is not running (%s)  - check the rsa access manager server logs\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_27_dsssh","title":"sc_27_dss.sh","text":"<pre><code>Scriptid: 27 - SignServer\n\nchecks the dss server\n\nError code / description - What to do\n\n271 / Document SignServer is active - No action needed\n272 / Document SignServer is running at ONLY ONE NODE - Check the failing node asap\n273 / Document SignServer is NOT active - resolve this issue asap\n274 / Document SignServer is not installed at this host - maybe you've configured wrong scripts or not yet installed signserver\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_28_check_vipsh","title":"sc_28_check_vip.sh","text":"<pre><code>Scriptid: 28 - VIP\n\nChecks which node has the VIP address\n\nError code / description - What to do\n\n281 / Node 1 has the VIP - No action needed\n282 / Node 2 has the VIP - No action needed\n283 / Both nodes has the VIP - Resolve this issue asap\n284 / None of the nodes has the VIP - Resolve this issue asap\n285 / ssh tool 915 not activated - enable 915\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_29_signserversh","title":"sc_29_signserver.sh","text":"<pre><code>Scriptid: 29 - SignServer health checker\n\nsignserver  Script that connects to the signserver health check servlet to check the status of the signserver application. The health check servlet checks JVM memory, database connection and HSM connection.\n\nError code / description - What to do\n\n291 / SIGNSERVER : %s - No action is needed\n292 / SIGNSERVER : %s - Possible errors: \n\"Error Virtual Memory is about to run out, currently free memory : X\" - you need to add more virtual memory to application server/java process\n\"Error Connecting to SIGNSERVER Database\" - The internal check of database failed, try to connect to database directly or restart database server\n\"CA Token is disconnected\" - activate token or maybe a restart of pcscd can help\n293 / SIGNSERVER : Application Server is unavailable - The server is non-responding, restart application-server (jboss) and/or check server log to find the fault\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_30_check_running_procssh","title":"sc_30_check_running_procs.sh","text":"<pre><code>Scriptid: 30 - Running processes\n\nGeneric script to check a proc is running and try to restart those that's not\n\nError code / description - What to do\n\n301 / Process %s is running - No action is needed\n302 / Process %s was not running, restart succeded - If this happens regulary this need to be looked into\n303 / Process %s was not running, restart failed - If this needs to be this handled manually\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_31_hp_healthsh","title":"sc_31_hp_health.sh","text":"<pre><code>Scriptid: 31 - HP Server health check\n\nCheck the HP Server health\n\nError code / description - What to do\n\n311 / Sensor of %s is OK %s - No action is needed\n312 / Temp sensor %s is NOT OK %s - Run manual test with hpasmcli\n313 / FAN sensor %s is NOT OK %s - Run manual test with hpasmcli\n314 / Tool not found: %s  - Install or set path\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_32_check_db_syncsh","title":"sc_32_check_db_sync.sh","text":"<pre><code>Scriptid: 32 - EJBCA DB Sync\n\nCheck if DB in sync\n\nError code / description - What to do\n\n321 / DB in sync - and updating databases\n322 / DB not in sync, date of CertificateData diff betwin nodes: - check error.log, probebly needing manual sync, se manual\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_33_healthcheckersh","title":"sc_33_healthchecker.sh","text":"<pre><code>Scriptid: 33 - Check Health of applications\n\nHealthcheck of applications with simple URL health (should return ALLOK and status 200)\n\nError code / description - What to do\n\n331 / app: %s ok - No action is needed\n332 / app: %s NOT ok error message: %s - Check errormessage and log-file\n333 / app: %s CHECKTOOL not curl nor wget - Config curl or wget\n334 / app: %s restarting due to previous failure status: %s command: %s restarts in last 24h: %s - Check errormessage and log-file\n335 / app: %s NOT restarting due to to many restarts in last 24h: %s - Check errormessage and log-file\n336 / app: %s, MAXRESTARTS not set - Config in the config file\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_34_redissh","title":"sc_34_redis.sh","text":"<pre><code>Scriptid: 34 - Redis\n\nCheck Redis VIP\n\nError code / description - What to do\n\n341 / server is OK at %s:%s (%s) - All is ok\n342 / server is not responding %s:%s (%s) - check the redis server is not responding\n343 / Input Arg problem %s - Check config\n344 / redis-cli is not found - install/configure redis-cli in config\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_35_dell_raidsh","title":"sc_35_dell_raid.sh","text":"<pre><code>Scriptid: 35 - Dell Hard drive checker\n\ncheck the raid discs\n\nError code / description - What to do\n\n351 / PhysicalDiscs is OK %s - No action is needed\n352 / PhysicalDiscs is not OK %s - Change disc as soon as possible\n353 / LogicalDiscs is OK %s - No action is needed\n354 / LogicalDiscs is rebuilding %s - check back in a while to see this error goes away, else you need to investigate\n355 / LogicalDiscs has some other error %s - you need to investigate this error ASAP\n356 / TOOL not installed at: %s - the tool is not installed, install the tool to get working reports\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_36_dell_healthsh","title":"sc_36_dell_health.sh","text":"<pre><code>Scriptid: 36 - Dell Server system components\n\ncheck dell system components\n\nError code / description - What to do\n\n361 / Component is OK %s - No action is needed\n362 / Component NOT OK %s - Change component as soon as possible\n363 / TOOL not installed at: %s - the tool is not installed, install the tool to get working reports\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"},{"location":"syscheck-scripts/#sc_37_monitor_jnlpsh","title":"sc_37_monitor_jnlp.sh","text":"<pre><code>Scriptid: 37 - Get remote URL and check status\n\nsc_37_monitor_internal_error.sh \n\nError code / description - What to do\n\n371 / ok: %s - No action is needed\n372 / problem: %s - problem found when getting the URL: %s\n373 / Can not find CURL tool: %s - Install/configure curl\n\nto run with output directed to screen: add a '-s' or '--screen'\n</code></pre>"}]}